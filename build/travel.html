<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏™‡∏ß‡∏¢‡πÜ</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f7ce29 0%, #bb80ffed 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header Section */
        .header-section {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
        }

        .header-title h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .header-title p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* Main Content Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        /* Search Section */
        .search-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            margin-bottom: 30px;
        }

        .search-controls {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 15px;
            align-items: center;
        }

        @media (max-width: 768px) {
            .search-controls {
                grid-template-columns: 1fr;
            }
        }

        .search-controls input, .search-controls select {
            padding: 12px 20px;
            border: 2px solid #f0f0f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }

        .search-controls input:focus, .search-controls select:focus {
            outline: none;
            border-color: #fbb034;
            box-shadow: 0 0 0 3px rgba(251, 176, 52, 0.2);
        }

        .search-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #fbb034, #ffdd00);
            color: #2c3e50;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(251, 176, 52, 0.4);
        }

        /* Map Section */
        .map-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            height: 600px;
        }

        #map {
            height: 100%;
            width: 100%;
            border-radius: 10px;
            border: 2px solid #f0f0f0;
        }

        /* Places List */
        .places-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .places-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #fbb034;
        }

        .places-list-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .place-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #fbb034;
            transition: all 0.3s;
            cursor: pointer;
        }

        .place-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .place-card.active {
            background: linear-gradient(135deg, #fbb034, #ffdd00);
            color: #2c3e50;
        }

        .place-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .place-category {
            display: inline-block;
            background: #e9ecef;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 8px;
            color: #495057;
        }

        .place-card.active .place-category {
            background: rgba(44, 62, 80, 0.1);
            color: #2c3e50;
        }

        .place-location {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .place-card.active .place-location {
            color: rgba(44, 62, 80, 0.8);
        }

        .place-level {
            display: inline-block;
            background: #e74c3c;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
        }

        .place-card.active .place-level {
            background: #c0392b;
        }

        /* Legend */
        .map-legend {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid white;
        }

        /* Custom Scrollbar */
        .places-list-container::-webkit-scrollbar {
            width: 8px;
        }

        .places-list-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .places-list-container::-webkit-scrollbar-thumb {
            background: #fbb034;
            border-radius: 4px;
        }

        .places-list-container::-webkit-scrollbar-thumb:hover {
            background: #e6a230;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .search-controls {
                grid-template-columns: 1fr;
            }
            
            .search-controls input, .search-controls select {
                width: 100%;
            }
            
            .header-title h1 {
                font-size: 2rem;
            }
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f0f0f0;
            border-top: 4px solid #fbb034;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Quick Stats */
        .quick-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            font-size: 0.9rem;
        }

        .quick-stat {
            text-align: center;
        }

        .quick-stat span {
            display: block;
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header-section">
            <div class="header-title">
                <h1>üöó ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏™‡∏ß‡∏¢‡πÜ ‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢</h1>
                <p>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏ó‡∏±‡πà‡∏ß‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</p>
            </div>
        </div>

        <!-- Search Section -->
        <div class="search-section">
            <div class="search-controls">
                <input type="text" id="search-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà...">
                <select id="filter-province">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>
                </select>
                <select id="filter-category">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                </select>
                <select id="filter-level">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
                    <option value="A">‡∏£‡∏∞‡∏î‡∏±‡∏ö A</option>
                    <option value="B">‡∏£‡∏∞‡∏î‡∏±‡∏ö B</option>
                    <option value="C">‡∏£‡∏∞‡∏î‡∏±‡∏ö C</option>
                </select>
                <button class="search-btn" onclick="applyFilters()">
                    üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-layout">
            <!-- Map Section -->
            <div class="map-section">
                <div id="map"></div>
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #e74c3c;"></div>
                        <span>‡∏£‡∏∞‡∏î‡∏±‡∏ö A</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #3498db;"></div>
                        <span>‡∏£‡∏∞‡∏î‡∏±‡∏ö B</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #2ecc71;"></div>
                        <span>‡∏£‡∏∞‡∏î‡∏±‡∏ö C</span>
                    </div>
                </div>
            </div>

            <!-- Places List -->
            <div class="places-section">
                <h2>üìå ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß</h2>
                <div class="quick-stats" id="quick-stats">
                    <div class="quick-stat">
                        <div>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        <span id="total-places">0</span>
                    </div>
                    <div class="quick-stat">
                        <div>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</div>
                        <span id="total-provinces">0</span>
                    </div>
                    <div class="quick-stat">
                        <div>‡∏£‡∏∞‡∏î‡∏±‡∏ö A</div>
                        <span id="level-a-count">0</span>
                    </div>
                </div>
                <div class="places-list-container" id="places-list">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
        let allPlaces = [];
        let map = null;
        let markers = [];
        let currentPlace = null;

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
            // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            setTimeout(() => {
                loadPlacesData();
            }, 1500);
        });

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
        function loadPlacesData() {
            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå datamini.js
                if (typeof tourpoint === 'undefined') {
                    allPlaces = generateSampleData();
                } else {
                    allPlaces = tourpoint.features || [];
                }
                
                console.log(`‚úÖ Loaded ${allPlaces.length} places`);
                updateDisplay();
                updateFilters();
                updateSummary();
            } catch (error) {
                console.error('‚ùå Error loading places:', error);
                document.getElementById('places-list').innerHTML = `
                    <div style="text-align: center; color: #e74c3c; padding: 40px;">
                        ‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br>
                        <strong>${error.message}</strong>
                    </div>
                `;
            }
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
        function generateSampleData() {
            const provinces = ["‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£", "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà", "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ", "‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ", "‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤", "‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô", "‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ", "‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ", "‡∏™‡∏á‡∏Ç‡∏•‡∏≤"];
            const categories = ["‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥", "‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°", "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏ä‡∏≤‡∏¢‡∏´‡∏≤‡∏î", "‡∏†‡∏π‡πÄ‡∏Ç‡∏≤", "‡∏ô‡πâ‡∏≥‡∏ï‡∏Å", "‡∏ß‡∏±‡∏î", "‡∏û‡∏¥‡∏û‡∏¥‡∏ò‡∏†‡∏±‡∏ì‡∏ë‡πå"];
            const levels = ["A", "B", "C"];
            
            const samplePlaces = [];
            
            for (let i = 1; i <= 50; i++) {
                const province = provinces[Math.floor(Math.random() * provinces.length)];
                const category = categories[Math.floor(Math.random() * categories.length)];
                const level = levels[Math.floor(Math.random() * levels.length)];
                
                samplePlaces.push({
                    type: "Feature",
                    properties: {
                        Name: `‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ${i}`,
                        category: category,
                        level: level,
                        Changwat: province
                    },
                    geometry: {
                        type: "Point",
                        coordinates: [
                            98 + Math.random() * 6, // longitude
                            13 + Math.random() * 6  // latitude
                        ]
                    }
                });
            }
            
            return samplePlaces;
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        function updateDisplay() {
            updatePlacesList();
            updateMap();
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
        function updatePlacesList() {
            const placesList = document.getElementById('places-list');
            
            if (allPlaces.length === 0) {
                placesList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #7f8c8d;">
                        ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß
                    </div>
                `;
                return;
            }

            placesList.innerHTML = '';

            allPlaces.forEach((place, index) => {
                const properties = place.properties;
                const card = document.createElement('div');
                card.className = 'place-card';
                card.onclick = () => selectPlace(place, index);
                
                card.innerHTML = `
                    <div class="place-name">
                        ${properties.Name || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠'}
                        <span class="place-level">${properties.level || '-'}</span>
                    </div>
                    <div class="place-category">${properties.category || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó'}</div>
                    <div class="place-location">üìç ${properties.Changwat || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'}</div>
                `;
                
                placesList.appendChild(card);
            });
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
        function updateMap() {
            if (!map) return;

            // ‡∏•‡πâ‡∏≤‡∏á marker ‡πÄ‡∏Å‡πà‡∏≤
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            // ‡πÄ‡∏û‡∏¥‡πà‡∏° marker ‡πÉ‡∏´‡∏°‡πà
            allPlaces.forEach((place, index) => {
                const properties = place.properties;
                const coordinates = place.geometry.coordinates;
                
                if (coordinates && coordinates.length === 2) {
                    const levelColor = getLevelColor(properties.level);
                    const marker = L.circleMarker([coordinates[1], coordinates[0]], {
                        radius: 8,
                        fillColor: levelColor,
                        color: '#fff',
                        weight: 2,
                        opacity: 1,
                        fillOpacity: 0.8
                    }).addTo(map);

                    marker.bindPopup(`
                        <div style="min-width: 200px;">
                            <h4 style="margin: 0 0 10px 0; color: #2c3e50;">${properties.Name || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠'}</h4>
                            <p style="margin: 2px 0; font-size: 12px;">
                                <strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ${properties.category || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}
                            </p>
                            <p style="margin: 2px 0; font-size: 12px;">
                                <strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö:</strong> ${properties.level || '-'}
                            </p>
                            <p style="margin: 2px 0; font-size: 12px;">
                                <strong>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</strong> ${properties.Changwat || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}
                            </p>
                            <div class="mt-2">
                                <button class="search-btn" onclick="selectPlaceFromMap(${index})" 
                                        style="padding: 5px 10px; font-size: 12px; width: 100%;">
                                    üëÄ ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                                </button>
                            </div>
                        </div>
                    `);

                    marker.placeIndex = index;
                    markers.push(marker);
                }
            });

            // Fit bounds ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á marker ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            if (markers.length > 0) {
                const group = new L.featureGroup(markers);
                map.fitBounds(group.getBounds().pad(0.1));
            } else {
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ marker ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
                map.setView([13.736717, 100.523186], 6);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
        function selectPlace(place, index) {
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            document.querySelectorAll('.place-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelectorAll('.place-card')[index].classList.add('active');
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
            const coordinates = place.geometry.coordinates;
            if (coordinates && coordinates.length === 2) {
                map.setView([coordinates[1], coordinates[0]], 13);
                
                // ‡πÄ‡∏õ‡∏¥‡∏î popup ‡∏Ç‡∏≠‡∏á marker ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                markers.forEach(marker => {
                    if (marker.placeIndex === index) {
                        marker.openPopup();
                    }
                });
            }
            
            currentPlace = place;
        }

        // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
        function selectPlaceFromMap(index) {
            const place = allPlaces[index];
            selectPlace(place, index);
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå
        function updateFilters() {
            const provinces = [...new Set(allPlaces.map(p => p.properties.Changwat).filter(Boolean))];
            const categories = [...new Set(allPlaces.map(p => p.properties.category).filter(Boolean))];

            updateFilterOptions('filter-province', provinces);
            updateFilterOptions('filter-category', categories);
        }

        function updateFilterOptions(selectId, options) {
            const select = document.getElementById(selectId);
            // ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏£‡∏Å (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
            const firstOption = select.options[0];
            select.innerHTML = '';
            select.appendChild(firstOption);
            
            options.sort().forEach(option => {
                const opt = document.createElement('option');
                opt.value = option;
                opt.textContent = option;
                select.appendChild(opt);
            });
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function updateSummary() {
            const provinces = new Set(allPlaces.map(p => p.properties.Changwat).filter(Boolean));
            const levelACount = allPlaces.filter(p => p.properties.level === 'A').length;

            document.getElementById('total-places').textContent = allPlaces.length.toLocaleString();
            document.getElementById('total-provinces').textContent = provinces.size.toLocaleString();
            document.getElementById('level-a-count').textContent = levelACount.toLocaleString();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        function applyFilters() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const province = document.getElementById('filter-province').value;
            const category = document.getElementById('filter-category').value;
            const level = document.getElementById('filter-level').value;

            let filtered = allPlaces.filter(place => {
                const properties = place.properties;
                const matchSearch = !searchTerm || 
                    (properties.Name && properties.Name.toLowerCase().includes(searchTerm));
                
                const matchProvince = !province || properties.Changwat === province;
                const matchCategory = !category || properties.category === category;
                const matchLevel = !level || properties.level === level;

                return matchSearch && matchProvince && matchCategory && matchLevel;
            });

            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß
            const tempPlaces = allPlaces;
            allPlaces = filtered;
            updateDisplay();
            allPlaces = tempPlaces; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
        function initMap() {
            map = L.map('map').setView([13.736717, 100.523186], 6); // ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        function getLevelColor(level) {
            const colors = {
                'A': '#e74c3c',
                'B': '#3498db',
                'C': '#2ecc71'
            };
            return colors[level] || '#95a5a6';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå
        function resetFilters() {
            document.getElementById('search-input').value = '';
            document.getElementById('filter-province').value = '';
            document.getElementById('filter-category').value = '';
            document.getElementById('filter-level').value = '';
            updateDisplay();
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ö‡∏ö real-time
        document.getElementById('search-input').addEventListener('input', applyFilters);
        document.getElementById('filter-province').addEventListener('change', applyFilters);
        document.getElementById('filter-category').addEventListener('change', applyFilters);
        document.getElementById('filter-level').addEventListener('change', applyFilters);
    </script>
</body>
</html>